<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="./assets/css/style.css" />
  </head>
  <body>
    <div class="container">
      <div class="input_container">
        <!-- Bar code Lable Size -->
        <div class="input_group">
          <div class="input">
            <label for="cart_type">Select Cart Type </label>
            <select id="cart_type">
              <option value="1">single</option>
              <option value="2">double</option>
              <option value="3">triple</option>
            </select>
          </div>
          <div class="input">
            <label for="cart_id">Enter Cart Id</label>
            <input type="number" placeholder="Enter Cart Id" id="cart_id" />
          </div>
          <div class="input">
            <label for="margin">Margin</label>
            <input type="number" placeholder="Enter Cart Id" id="margin" />
          </div>

          <div class="input">
            <button type="button" id="make_lable">Submit</button>
            <button type="button">Reset</button>
          </div>
        </div>
      </div>
      <div class="barcode_lable_display">
        <div class="barcode_lable" id="barcode_lable"></div>
      </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.5/barcodes/JsBarcode.code128.min.js"></script>
    <script>
      // Define

      let lable_diplay = document.getElementById("barcode_lable");
      let MakeBtn = document.getElementById("make_lable");

      // bar code lable db
      var barcode_db = JSON.parse(localStorage.getItem("barcode_db"));
      if (barcode_db === null) {
        barcode_db = [];
        barcode_db = [];
        localStorage.setItem("barcode_db", JSON.stringify(barcode_db));
      }

      //  print bar code labals
      const print_barcode_lable = () => {
        lable_diplay.innerHTML = "";
        var barcode_db = JSON.parse(localStorage.getItem("barcode_db"));
        for (let i = 0; i < barcode_db.length; i++) {
          var barcode_lables = barcode_db[i].svg_lable;
          lable_diplay.innerHTML += barcode_lables;
        }
      };

      //   make bar code lable
      MakeBtn.addEventListener("click", () => {
        barcode_db = [];
        localStorage.setItem("barcode_db", JSON.stringify(barcode_db));
        let cart_id = document.getElementById("cart_id").value;
        let lable_cart_type = document.getElementById("cart_type").value;

        if (lable_cart_type == 1) {
          console.log("single");
          var cartID = `S-${cart_id}`;
        }
        if (lable_cart_type == 2) {
          console.log("double");
          var cartID = `D-${cart_id}`;
        }
        if (lable_cart_type == 3) {
          console.log("triple");
          var cartID = `T-${cart_id}`;
        }

        if (cart_id != "") {
          var svg_lable = `<svg class="barcode" jsbarcode-format="code128" jsbarcode-value="${cartID}" jsbarcode-textmargin="0" jsbarcode-fontoptions="bold"></svg>`;
          var dt = new Date();
          var push_lable = { dt, svg_lable };
          barcode_db.push(push_lable);
          localStorage.setItem("barcode_db", JSON.stringify(barcode_db));

          for (var i = 1; i <= 6; i++) {
            if (lable_cart_type == 1) {
              console.log("single");
              var lableVal = `S${cart_id}R-0${i}`;
            }
            if (lable_cart_type == 2) {
              console.log("double");
              var lableVal = `D${cart_id}R-0${i}`;
            }
            if (lable_cart_type == 3) {
              console.log("triple");
              var lableVal = `T${cart_id}R-0${i}`;
            }
            var svg_lable = `<svg class="barcode" jsbarcode-format="code128" jsbarcode-value="${lableVal}" jsbarcode-textmargin="0" jsbarcode-fontoptions="bold"></svg>`;
            var dt = new Date();
            var push_lable = { dt, svg_lable };
            barcode_db.push(push_lable);
            localStorage.setItem("barcode_db", JSON.stringify(barcode_db));
          }
          location.reload();
        } else {
          alert("Plasea cart id");
        }
      });

      print_barcode_lable();

      JsBarcode(".barcode").init();
    </script>
  </body>
</html>
