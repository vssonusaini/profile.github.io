<!DOCTYPE html>
<html lang="en">
  <body>
    <div class="col-md-12 portfolio-content">
      <div class="col-md-12 features">
        <div class="namenprice">
          <h1 class="blog-title pull-left">EMI Calculator</h1>
          <h2 class="price pull-right" id="r4"></h2>
        </div>
        <div class="col-md-12 top_20"></div>
        <!-- Details -->

        <div class="row">
          <div class="col-md-12 details top_30 bottom_10">
            <ul class="row">
              <li class="col-md-4" style="font-size: 1rem"><span>Monthly EMI:</span> <span id="r1"></span></li>
              <li class="col-md-4" style="font-size: 1rem"><span>Principal Amount:</span> <span id="r2"></span></li>
              <li class="col-md-4" style="font-size: 1rem"><span>Total Interest:</span> <span id="r3"></span></li>
            </ul>
          </div>
          <div class="col-md-8 top_30 bottom_30">
            <form class="site-form" method="post" autocomplete="off" name="google-sheet">
              <div class="row">
                <div class="col-md-6">
                  <label for="inputAmount">Loan Amount</label>
                  <span>₹<input class="site-input" name="Amount" id="inputAmount" type="number" step="50000" value="1000000" min="100000" max="10000000" oninput="showValAmount(this.value)" /></span>
                  <input class="slider" name="realAmount" id="myAmount" type="range" step="50000" value="1000000" min="100000" max="10000000" />
                </div>
                <div class="col-md-6">
                  <label for="inputRoi">Rate of Interest (P.A) %</label>
                  <span><input class="site-input" name="Returns" id="inputRoi" type="number" value="8.5" min="1" max="30" step="0.05" oninput="showValRoi(this.value)" /></span>
                  <input class="slider" name="realRoi" id="myRoi" type="range" value="8.5" min="1" max="30" step="0.05" />
                </div>
                <div class="col-md-6">
                  <label for="inputRoi">Loan Tenure Year</label>
                  <span><input class="site-input" name="Years" id="inputYears" type="number" value="10" min="1" step="1" max="30" oninput="showValYears(this.value)" /></span>
                  <input class="slider" name="realYears" id="myYears" type="range" value="10" min="1" step="1" max="30" />
                </div>
              </div>
            </form>
          </div>
          <div class="col-md-4 top_45 bottom_30">
            <div class="chart">
              <canvas id="myChart" width="300" height="300"></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Description -->
      <div class="col-md-12 description">
        <p>The credit market in India is steadily on the rise. It is currently the 4th largest credit industry in the world, recording a CAGR of over 11% year-on-year. A vast majority of these advances are short-term credits such as personal loans and credit cards. Combined, these two financial products account for 78% of all credit lending in India. Loan repayments include EMIs and borrower should consider the EMI amount to accurately plan their current and future finances.</p>
        <p>There are several EMI calculators available online; one must choose an accurate EMI calculator and learn its usage to calculate the exact EMI amount they are liable to pay for a loan.</p>
      </div>

      <!-- Social -->
      <div class="social-share col-md-12 bottom_60 top_45 text-center">
        <ul>
          <li>
            <a href="#"><i class="fa fa-facebook" aria-hidden="true"></i></a>
          </li>
          <li>
            <a href="#"><i class="fa fa-twitter" aria-hidden="true"></i></a>
          </li>
          <li>
            <a href="#"><i class="fa fa-google-plus" aria-hidden="true"></i></a>
          </li>
          <li>
            <a href="#"><i class="fa fa-pinterest" aria-hidden="true"></i></a>
          </li>
        </ul>
      </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js" integrity="sha512-s+xg36jbIujB2S2VKfpGmlC3T5V2TF3lY48DX7u2r9XzGzgPsa6wTpOQA7J9iffvdeBN0q9tKzRxVxw1JviZPg==" crossorigin="anonymous"></script>

    <script>
      "use strict";
      var amountSlider = document.getElementById("myAmount");
      var amountOutput = document.getElementById("inputAmount");
      var roiSlider = document.getElementById("myRoi");
      var roiOutput = document.getElementById("inputRoi");
      var yearSlider = document.getElementById("myYears");
      var yearOutput = document.getElementById("inputYears");

      amountOutput.value = amountSlider.value;
      roiOutput.value = roiSlider.value;
      yearOutput.value = yearSlider.value;

      amountSlider.oninput = function () {
        amountOutput.innerHTML = this.value;
      };
      roiSlider.oninput = function () {
        roiOutput.innerHTML = this.value;
      };
      yearSlider.oninput = function () {
        yearOutput.innerHTML = this.value;
      };

      function showValAmount(newVal) {
        amountSlider.value = newVal;
        calculateIt();
      }
      function showValRoi(newVal) {
        roiSlider.value = newVal;
        calculateIt();
      }
      function showValYears(newVal) {
        yearSlider.value = newVal;
        calculateIt();
      }

      amountSlider.addEventListener("input", updateValueAmount);
      roiSlider.addEventListener("input", updateValueRoi);
      yearSlider.addEventListener("input", updateValueYears);

      function updateValueAmount(e) {
        amountOutput.value = e.srcElement.value;
        calculateIt();
      }
      function updateValueRoi(e) {
        roiOutput.value = e.srcElement.value;
        calculateIt();
      }
      function updateValueYears(e) {
        yearOutput.value = e.srcElement.value;
        calculateIt();
      }

      AttachInputListeners();
      var initialLoad = true;
      var chart;
      getParams();
      calculateIt();

      function calculateIt() {
        var monthlyEMI = document.getElementById("r1");
        var pricipalAmount = document.getElementById("r2");
        var totalInterest = document.getElementById("r3");
        var totalAmount = document.getElementById("r4");

        var A, R, N;

        A = Number(amountOutput.value);
        R = Number(roiOutput.value);
        N = Number(yearOutput.value);

        if (A >= 100000 && R >= 1) {
          let n = N * 12;
          let i = R / (100 * 12);

          var monthlyEMIval = Math.round(A * i * (Math.pow(1 + i, n) / (Math.pow(1 + i, n) - 1)));
          var totalInterestVal = monthlyEMIval * N * 12 - A;
          var totalAmountVal = monthlyEMIval * N * 12;

          monthlyEMI.innerHTML = "₹ " + monthlyEMIval.toLocaleString();
          pricipalAmount.innerHTML = "₹ " + A.toLocaleString();
          totalInterest.innerHTML = "₹ " + totalInterestVal.toLocaleString();
          totalAmount.innerHTML = "Total Amount ₹ " + totalAmountVal.toLocaleString();

          if (!initialLoad) {
            chart.destroy();
          }
          DrawChart(A, totalInterestVal);
          initialLoad = false;
        }
      }

      function DrawChart(A, totalInterestVal) {
        var ctx = document.getElementById("myChart").getContext("2d");

        chart = new Chart(ctx, {
          type: "doughnut",
          data: {
            labels: ["Principal Amount", "Interest Amount"],
            datasets: [
              {
                backgroundColor: ["Orange", "#32CD32"],
                data: [A, totalInterestVal],
              },
            ],
          },
          options: {
            segmentShowStroke: false,
            responsive: true,
          },
        });
      }

      function getParams() {
        let urlVal = window.location.href;
        let url = new URL(urlVal);
        let type = url.searchParams.get("type");
        let name = url.searchParams.get("name");
        let cta = url.searchParams.get("cta");
        let logo = url.searchParams.get("logo");

        let heading = document.getElementById("heading");

        if (type === "home") {
          amountOutput.value = "2500000";
          roiOutput.value = "7.25";
          yearOutput.value = "20";
          if (name !== null) {
            heading.innerHTML = name + " Home Loan EMI Calculator";
          } else {
            heading.innerHTML = "Home Loan EMI Calculator";
          }
        } else if (type === "car") {
          amountOutput.value = "1000000";
          roiOutput.value = "9.5";
          yearOutput.value = "7";
          if (name !== null) {
            heading.innerHTML = name + " Car Loan EMI Calculator";
          } else {
            heading.innerHTML = "Car Loan EMI Calculator";
          }
        } else if (type === "personal") {
          amountOutput.value = "500000";
          roiOutput.value = "13.5";
          yearOutput.value = "5";
          if (name !== null) {
            heading.innerHTML = name + " Personal Loan EMI Calculator";
          } else {
            heading.innerHTML = "Personal Loan EMI Calculator";
          }
        } else {
          if (name !== null) {
            heading.innerHTML = name + " EMI Calculator";
          } else {
            heading.innerHTML = "EMI Calculator";
          }
        }

        if (cta === "hide") {
          let ctaDiv = document.getElementById("cta");
          ctaDiv.style.display = "none";
        }

        if (logo === "true") {
          document.getElementById("logo").style.display = "block";
        }
      }

      function AttachInputListeners() {
        amountOutput.addEventListener("input", (e) => {
          let val = Number(e.target.value);
          if (val < 0) {
            amountOutput.value = 100000;
            calculateIt();
          }
          if (val > 10000000) {
            amountOutput.value = 10000000;
            calculateIt();
          }
        });

        roiOutput.addEventListener("input", (e) => {
          let val = Number(e.target.value);
          if (val < 0) {
            roiOutput.value = 1;
            calculateIt();
          }
          if (val > 30) {
            roiOutput.value = 30;
            calculateIt();
          }
        });

        yearOutput.addEventListener("input", (e) => {
          let val = Number(e.target.value);
          if (!Number.isInteger(val)) {
            val = Math.ceil(val);
            yearOutput.value = val;
            calculateIt();
          }
          if (val < 1) {
            yearOutput.value = 1;
            calculateIt();
          }
          if (val > 30) {
            yearOutput.value = 30;
            calculateIt();
          }
        });
      }
    </script>
  </body>
</html>
